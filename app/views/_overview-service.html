<div ng-if="!(deployments | hashSize) && !(monopods | hashSize)" class="no-deployments-block">
  <h2>No deployments.</h2>
  <p>
    There are no deployments or pods for service
    <a ng-href="{{service | navigateResourceURL}}">{{service.metadata.name}}</a>.
  </p>
</div>

<!-- latest deployment -->
<div ng-repeat="latestDeployment in deployments track by (latestDeployment | uid)"
    ng-if="isDeploymentVisible(latestDeployment) && isDeploymentLatest(latestDeployment)"
    ng-init="dcName = (latestDeployment | annotation : 'deploymentConfig')"
    class="deployment-tile">
  <div row class="service-title">
    <div>
      Service:
      <a ng-href="{{service | navigateResourceURL}}">{{service.metadata.name}}</a>
    </div>
    <!-- <div class="text-muted"> -->
    <!--   <span data-icon="î€²" aria-hidden="true" style="font-size:16px; vertical-align: middle;"></span> -->
    <!--   <span ng-if="service.spec.ports.length === 1"> -->
    <!--     {{service.spec.ports[0].port}} -->
    <!--   </span> -->
    <!--   <span ng-if="service.spec.ports.length > 1"> -->
    <!--     {{service.spec.ports.length}} ports -->
    <!--   </span> -->
    <!-- </div> -->
    <div>
      <relative-timestamp timestamp="latestDeployment.metadata.creationTimestamp"></relative-timestamp>
    </div>
  </div>
  <div class="deployment-header">
    <div ng-if="dcName" column flex class="shield">
      <a ng-href="{{latestDeployment | navigateResourceURL}}">
        <span class="shield-number">#{{latestDeployment | annotation: 'deploymentVersion'}}</span>
      </a>
    </div>
    <div row ng-if="!dcName" class="rc-header">
      <a ng-href="{{latestDeployment | navigateResourceURL}}">{{latestDeployment.metadata.name}}</a>
    </div>
    <div row class="deployment-body">
      <!-- other visible deployment(s) -->
      <!-- usually the last active when one is in progress -->
      <div column
          ng-repeat="deployment in visibleDeployments(deployments) | orderObjectsByDate : true track by (deployment | uid)"
          ng-init="dcName = (deployment | annotation : 'deploymentConfig')"
          ng-if="!isDeploymentLatest(deployment)"
          class="overview-donut">
        <deployment-donut
            rc="deployment"
            deployment-config="deploymentConfigs[(deployment | annotation : 'deploymentConfig')]"
            pods="podsByDeployment[deployment.metadata.name]"
            hpa="getHPA(deployment.metadata.name, dcName)"
            limit-ranges="limitRanges"
            scalable="isScalableDeployment(deployment, deploymentConfigs, hpaByDc, hpaByRc, scalableDeploymentByConfig)"
            alerts="alerts">
        </deployment-donut>
      </div>
      <div ng-if="deployments | anyDeploymentIsInProgress" column class="overview-donut-connector">
        &rarr;
        <span>deploying</span>
      </div>
      <!-- /other visible deployment(s) -->
      <!-- latest deployment -->
      <div column class="overview-donut latest">
        <deployment-donut
            rc="latestDeployment"
            deployment-config="deploymentConfigs[dcName]"
            pods="podsByDeployment[latestDeployment.metadata.name]"
            hpa="getHPA(latestDeployment.metadata.name, dcName)"
            limit-ranges="limitRanges"
            scalable="isScalableDeployment(latestDeployment, deploymentConfigs, hpaByDc, hpaByRc, scalableDeploymentByConfig)"
            alerts="alerts">
        </deployment-donut>
      </div>
      <div ng-if="!(deployments | anyDeploymentIsInProgress)" column class="overview-metrics">
        <metrics ng-if="metricsAvailable" deployment="latestDeployment" profile="compact"></metrics>
        <div ng-if="!metricsAvailable">
          <pod-template pod-template="latestDeployment.spec.template"></pod-template>
        </div>
      </div>
      <!-- /latest deployment -->
    </div>
  </div>
</div>
<!-- /latest deployment -->

<!-- monopods -->
<div ng-repeat="pod in monopods | orderObjectsByDate : true track by (pod | uid)"
     class="deployment-tile">
  <div row class="service-title">
    <div>
      Service:
      <a ng-href="{{service | navigateResourceURL}}">{{service.metadata.name}}</a>
    </div>
    <div>
      <relative-timestamp timestamp="pod.metadata.creationTimestamp"></relative-timestamp>
    </div>
  </div>
  <div row class="rc-header"> <!-- TODO may want different treatment for a pod-name? -->
    <a ng-href="{{pod | navigateResourceURL}}">{{pod.metadata.name}}</a>
  </div>
  <div row class="deployment-body">
    <div column class="overview-donut">
      <pod-donut pods="[pod]"></pod-donut>
    </div>
    <div column class="overview-metrics">
      <metrics pod="pod" profile="compact"></metrics>
    </div>
  </div>
</div>
<!-- /monopods -->
